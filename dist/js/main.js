(()=>{"use strict";const t=[{img:"/img/slide_1.png"},{img:"/img/slide_2.png"},{img:"/img/slide_3.png"}],e=document.querySelector(".slider__image"),n=document.querySelectorAll(".slider__dot");let o=0;function i(i){o!=i&&(n[o].classList.toggle("slider__dot_active"),n[i].classList.toggle("slider__dot_active"),e.src=t[i].img,o=i)}for(let t=0;t<n.length;t++)n[t].addEventListener("click",(()=>{i(t)}));function s(t,e,n,o,i,s,a){const c=document.createElement("div");c.classList.add("main-content__book-card");const l=document.createElement("img");l.classList.add("main-content__book-cover"),0==e?l.setAttribute("src","/img/example-cover.png"):l.setAttribute("src",e),l.setAttribute("alt","book cover");const r=document.createElement("div");r.classList.add("main-content__book-info");const u=document.createElement("p");u.classList.add("main-content__book-author"),u.textContent=t;const m=document.createElement("p");m.classList.add("main-content__book-name"),m.textContent=n;const d=document.createElement("div");if(null!=o){d.classList.add("main-content__book-rating");for(let t=0;t<5;t++){let e=Math.floor(o),n=document.createElement("span");n.classList.add("main-content__book-rating-star"),n.textContent="★",e-1>=t&&n.classList.add("main-content__book-rating-star_active"),d.append(n)}const t=document.createElement("span");t.classList.add("main-content__book-reviews"),t.textContent=`${i} review`,d.append(t)}const g=document.createElement("p");g.classList.add("main-content__book-description"),g.textContent=s;const _=document.createElement("p");_.classList.add("main-content__book-price"),_.textContent=a;const b=document.createElement("button");b.classList.add("button","button_buy-button","button_buy-button-active"),b.textContent="buy now",r.append(u,m,d,g,_,b),c.append(l,r),document.querySelector(".main-content__book-catalog").append(c)}setInterval((function(){o==t.length-1?i(0):i(o+1)}),5e3);const a=["subject:Architecture","subject:Art","subject:Biography&Autobiography","subject:Business","subject:Crafts&Hobbies","subject:Drama","subject:Fiction","subject:Cooking","subject:Health&Fitness","subject:History","subject:Humor","subject:Poetry","subject:Psychology","subject:Science","subject:Technology","subject:Travel"],c="AIzaSyDQNaxmJEUQ2_ySf9hL41JpK439DoaBxwY",l=document.querySelector(".main-content__book-catalog"),r=document.querySelectorAll(".main-content__navigation-list-item"),u=document.querySelector(".button_load-more-button"),m=document.querySelector(".header__shoping-cart-quantity"),d=document.querySelector(".header__shoping-cart-quantity-text");let g=[];null!=JSON.parse(localStorage.getItem("cashedCart"))&&(g=JSON.parse(localStorage.getItem("cashedCart")),d.innerText=g.length,m.classList.toggle("header__shoping-cart-quantity_disabled"));let _,b,h=[],v=[];function p(t){h=[],h=document.querySelectorAll(".button_buy-button");for(let e=t;e<h.length;e++)h[e].addEventListener("click",(()=>{var t;h[t=e].classList.contains("button_buy-button-active")?(h[t].classList.toggle("button_buy-button-active"),h[t].innerText="in the cart",g.push(v[t]),localStorage.setItem("cashedCart",JSON.stringify(g)),console.log(g),1==g.length&&m.classList.toggle("header__shoping-cart-quantity_disabled"),d.innerText=g.length):(h[t].classList.toggle("button_buy-button-active"),h[t].innerText="buy now",g=g.filter((e=>JSON.stringify(e)!==JSON.stringify(v[t]))),localStorage.setItem("cashedCart",JSON.stringify(g)),console.log(g),0==g.length&&m.classList.toggle("header__shoping-cart-quantity_disabled"),d.innerText=g.length)}))}async function f(t,e){let n=[];return await fetch(`https://www.googleapis.com/books/v1/volumes?q="${t}"&key=${c}&printType=books&startIndex=${e}&maxResults=6&langRestrict=en`).then((t=>t.json())).then((t=>{let e={};for(let o=0;o<6;o++){if(e={},null==t.items[o].volumeInfo.authors)e.author="no author";else if(t.items[o].volumeInfo.authors.length>1){let n=t.items[o].volumeInfo.authors.join(", ");e.author=n}else e.author=t.items[o].volumeInfo.authors[0];null==t.items[o].volumeInfo.imageLinks?e.cover=!1:e.cover=t.items[o].volumeInfo.imageLinks.thumbnail,e.title=t.items[o].volumeInfo.title,e.rating=t.items[o].volumeInfo.averageRating,null==t.items[o].volumeInfo.ratingsCount?e.reviews="No":e.reviews=t.items[o].volumeInfo.ratingsCount,e.description=t.items[o].volumeInfo.description,"NOT_FOR_SALE"==t.items[o].saleInfo.saleability?e.price="":"FREE"==t.items[o].saleInfo.saleability?e.price="free":e.price=`${t.items[o].saleInfo.retailPrice.amount} ₽`,n.push(e)}})),n}async function y(t,e){b=0,_=e,l.replaceChildren(),v=[];let n=await f(t,b);document.querySelector(".main-content__navigation-list-item-active").classList.toggle("main-content__navigation-list-item-active"),r[e].classList.toggle("main-content__navigation-list-item-active");for(let t=0;t<6;t++)v.push(n[t]),s(n[t].author,n[t].cover,n[t].title,n[t].rating,n[t].reviews,n[t].description,n[t].price);p(b),L()}function L(){for(let t=0;t<v.length;t++)for(let e=0;e<g.length;e++)JSON.stringify(v[t])===JSON.stringify(g[e])&&(h[t].classList.toggle("button_buy-button-active"),h[t].innerText="in the cart")}for(let t=0;t<r.length;t++)r[t].addEventListener("click",(()=>{y(a[t],t)}));u.addEventListener("click",(()=>{!async function(){b+=6;let t=await f(a[_],b);for(let e=0;e<6;e++)v.push(t[e]),s(t[e].author,t[e].cover,t[e].title,t[e].rating,t[e].reviews,t[e].description,t[e].price);p(b),L()}()})),y(a[0],0),L()})();